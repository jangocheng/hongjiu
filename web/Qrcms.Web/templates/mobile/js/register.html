<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>注册账号</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="<%templateskin%>/css/mui.css" rel="stylesheet" />
		<link href="<%templateskin%>/css/style.css" rel="stylesheet" />
		<style type="text/css">
			.mui-toast-container{
				bottom: 15%;
			}
		</style>
	</head>

	<body style="min-height: 100%;background: #F2F2F2;">
		<div class="mui-content register">
		    <div class="mui-input-group">
		    	<form id="register_form">
			        <div class="mui-input-row">
			            <input type="tel" name="txtMobile" id="txtPhone" datatype="phone" errormsg="请输入正确的手机号！" class="mui-input-clear" placeholder="请输入手机号码">
			            <button id="getCode">获取验证码</button>
			        </div>
			        <div class="mui-input-row">
			            <input type="password" name="txtCode" id="txtCode" class="mui-input-clear" datatype="notnull" errormsg="请输入验证码！" placeholder="请输入手机验证码">
			        </div>
			        <div class="mui-input-row">
			            <input type="password" name="txtPassword" id="txtPassword" datatype="notnull" errormsg="请输入密码！" class="mui-input-clear" placeholder="请设置登陆密码">
			        </div>
		        </form>
		    </div>
		    <button id="register_submit" type="button" class="mui-btn mui-btn-blue mui-btn-block regbtn">立即注册</button>
		    <p>注册即同意<a href="">《用户协议》</a></p>
		</div>
		
	
		
	</body>
	<script src="<%templateskin%>/js/jquery-3.0.0.min.js"></script>
	<script src="<%templateskin%>/js/mui.min.js"></script>
	<script src="<%templateskin%>/js/common.js"></script>
	<script>
		mui.init();
		/*向手机发送验证码*/
		mui('body').on('tap','#getCode',function(){
			sendSMS('#getCode','#txtPhone','/tools/submit_ajax.ashx?action=user_verify_smscode&site=main');
		});
		
		/*提交用户注册的相关数据*/
		mui('body').on('tap','#register_submit',function(){
			var formdata = serialize(document.getElementById('register_form'));
			console.log(formdata);
			if(getValid('register_form')){
				
				mui.ajax("/tools/submit_ajax.ashx?action=user_register&site=main",{
					data:{
						'txtPhone':document.getElementById('txtPhone').value,
						'txtCode':document.getElementById('txtCode').value,
						'txtPassword':document.getElementById('txtPassword').value
					},
					dataType:'json',
					type:"post",
					async:false,
					success:function(data){
						if(data.status == "1"){
								mui.toast(data.msg)
								setTimeout(function(){
									window.location.href = data.url;
								},1000)
							}else{
								mui.toast(data.msg)
							}
					}
					
				})
			}
		})
		/**/
	</script>
</html>